import pandas as pd
import openpyxl
from openpyxl.styles import Font
from openpyxl.worksheet.hyperlink import Hyperlink

# Assuming your DataFrame is named 'df'
# If it's not, replace 'df' with the actual name of your DataFrame
# df = pd.read_csv('your_data.csv')  # Uncomment and modify if you need to load data

# Export DataFrame to Excel
excel_file = 'output.xlsx'
df.to_excel(excel_file, index=False, engine='openpyxl')

# Open the workbook and select the active sheet
wb = openpyxl.load_workbook(excel_file)
sheet = wb.active

# Add hyperlinks to the ID column
id_col = df.columns.get_loc('ID') + 1  # +1 because openpyxl is 1-indexed
for row in sheet.iter_rows(min_row=2, max_row=sheet.max_row, min_col=id_col, max_col=id_col):
    for cell in row:
        id_value = cell.value
        hyperlink = f"https://google.com/{id_value}"
        cell.hyperlink = Hyperlink(ref=cell.coordinate, target=hyperlink)
        cell.font = Font(color="0000FF", underline="single")  # Blue, underlined text

# Save the workbook
wb.save(excel_file)

print(f"Excel file '{excel_file}' has been created with hyperlinks in the ID column.")
